<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manike.AI - Your AI-Powered Travel Planner</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <!-- Mobile hamburger toggle -->
        <button id="sidebarToggle" class="sidebar-toggle" aria-label="Toggle menu">&#9776;</button>
        <div id="sidebarOverlay" class="sidebar-overlay"></div>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1 class="logo">ğŸ›ï¸ Manike.AI</h1>
                <p class="tagline">Your Sri Lankan Travel Planner</p>
            </div>

            <button id="newChatBtn" class="btn btn-primary btn-full">
                + New Chat
            </button>

            <!-- My Chats -->
            <div class="sidebar-section" id="myChatsSection">
                <h3>My Chats</h3>
                <div id="myChatsList" class="past-chats-list"></div>
            </div>

            <!-- Shared With Me -->
            <div class="sidebar-section" id="sharedChatsSection">
                <h3>Shared With Me</h3>
                <div id="sharedChatsList" class="past-chats-list"></div>
            </div>

            <div class="sidebar-section">
                <h3>Features</h3>
                <ul class="feature-list">
                    <li>ğŸ’¬ Natural conversation</li>
                    <li>ğŸ“… Smart scheduling</li>
                    <li>ğŸ’° Budget planning</li>
                    <li>ğŸ“ Location mapping</li>
                    <li>ğŸ–¼ï¸ AI image matching</li>
                    <li>ğŸ¬ Cinematic clips</li>
                </ul>
            </div>

            <div style="margin-top: auto; padding-top: 24px;">
                <button id="logoutBtn" class="btn btn-full" style="background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.3); color: white; cursor: pointer;">
                    Logout
                </button>
            </div>
        </aside>

        <!-- Main Chat Area -->
        <main class="chat-area">
            <div class="chat-header">
                <div class="header-content">
                    <h2>Manike.AI Chat</h2>
                    <p id="headerStatus" class="header-status">Ready to help</p>
                </div>
                <div class="header-actions">
                    <button id="videoModeToggle" class="btn btn-secondary video-mode-btn" style="display: none;">
                        <span class="video-icon">ğŸ¥</span> Video Mode
                    </button>
                </div>
            </div>

            <!-- Avatar Video Container (hidden by default) -->
            <div id="avatarContainer" class="avatar-container" style="display: none;">
                <video id="avatarVideo" autoplay playsinline></video>
                <div class="avatar-status">
                    <span id="avatarStatus">Initializing...</span>
                </div>
            </div>

            <div id="chatMessages" class="chat-messages">
                <div class="message assistant-message">
                    <div class="message-avatar">ğŸ¤–</div>
                    <div class="message-content">
                        <p>Hello! I'm your AI travel planning assistant. I'm here to help you create the perfect itinerary for your next adventure!</p>
                        <p>Let's get started. Could you tell me:</p>
                        <ul>
                            <li>What's your name?</li>
                            <li>Where are you thinking of traveling?</li>
                            <li>When would you like to travel?</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="chat-input-area">
                <!-- Text Input Mode -->
                <div id="inputContainer" class="input-container">
                    <input
                        type="text"
                        id="messageInput"
                        class="message-input"
                        placeholder="Type your travel preferences here..."
                        autocomplete="off"
                    >
                    <button id="sendBtn" class="btn btn-send">
                        <span>Send</span>
                        <span class="send-icon">-></span>
                    </button>
                </div>

                <!-- Voice Input Mode (hidden by default) -->
                <div id="voiceInputContainer" class="voice-input-container" style="display: none;">
                    <div class="voice-status-main">
                        <span id="voiceStatus">Initializing...</span>
                    </div>
                    <div class="voice-transcript-area">
                        <span id="interimTranscript" class="interim-transcript"></span>
                    </div>
                    <div class="voice-controls">
                        <button id="voiceButton" class="btn btn-voice-mute" title="Tap to mute/unmute">
                            <span class="mic-icon">ğŸ¤</span>
                        </button>
                        <button id="exitVideoMode" class="btn btn-secondary btn-small">
                            Exit Video Mode
                        </button>
                    </div>
                </div>

                <div id="loadingSpinner" class="loading-spinner" style="display: none;">
                    <div class="spinner"></div>
                    <p>Generating your itinerary with AI + media matching...</p>
                </div>
            </div>

            <button id="viewItineraryBtn" class="view-itinerary-btn" style="display: none;">
                ğŸ“‹ View Itinerary
            </button>
        </main>

        <!-- Itinerary Panel -->
        <aside id="itineraryPanel" class="itinerary-panel" style="display: none;">
            <div class="panel-header">
                <button id="backToChat" class="back-to-chat-btn">&#8592; Back to Chat</button>
                <h3>Your Itinerary</h3>
                <button id="closePanel" class="close-btn">Ã—</button>
            </div>

            <div id="itineraryUpdatingOverlay" class="itinerary-updating-overlay" style="display: none;">
                <div class="spinner"></div>
                <span>Updating your itinerary...</span>
            </div>

            <div id="itineraryContent" class="itinerary-content">
                <!-- Itinerary will be rendered here -->
            </div>
        </aside>
    </div>

    <!-- Resume Session Confirmation Modal -->
    <div id="resumeConfirmModal" class="restore-modal" style="display:none;">
        <div class="restore-modal-backdrop" id="resumeModalBackdrop"></div>
        <div class="restore-modal-card" style="width: min(420px, 90vw);">
            <div class="restore-modal-header">
                <h3 id="resumeModalTitle">Resume Chat</h3>
                <button class="close-btn" id="closeResumeModal">Ã—</button>
            </div>
            <div class="restore-modal-body" style="padding: 20px;">
                <p id="resumeModalDesc" style="color: rgba(255,255,255,0.85); font-size: 14px; line-height: 1.6;"></p>
            </div>
            <div class="restore-modal-actions">
                <button class="btn btn-secondary btn-small" id="resumeCancelBtn">Cancel</button>
                <button class="btn btn-primary btn-small" id="resumeConfirmBtn">Resume Chat</button>
            </div>
        </div>
    </div>

    <!-- Delete Chat Confirmation Modal -->
    <div id="deleteConfirmModal" class="restore-modal" style="display:none;">
        <div class="restore-modal-backdrop" id="deleteModalBackdrop"></div>
        <div class="restore-modal-card" style="width: min(420px, 90vw);">
            <div class="restore-modal-header">
                <h3>Delete Chat</h3>
                <button class="close-btn" id="closeDeleteModal">Ã—</button>
            </div>
            <div class="restore-modal-body" style="padding: 20px;">
                <p id="deleteModalDesc" style="color: rgba(255,255,255,0.85); font-size: 14px; line-height: 1.6;"></p>
            </div>
            <div class="restore-modal-actions">
                <button class="btn btn-secondary btn-small" id="deleteCancelBtn">Cancel</button>
                <button class="btn btn-danger btn-small" id="deleteConfirmBtn">Delete</button>
            </div>
        </div>
    </div>

    <!-- Voice Input Manager -->
    <script src="/static/js/voice-input.js?v=3"></script>
    <!-- HeyGen Avatar Manager -->
    <script src="/static/js/heygen-avatar.js?v=3"></script>
    <!-- Main Application -->
    <script src="/static/js/app.js?v=3"></script>
</body>
</html>
